---
title: 微信第三方小程序开发的坑
date: 2019-01-17
categories: fun
tag: 小程序
---

### 微信第三方平台设置的坑
1. 授权测试公众号列表配置,在未全网发布前只有这里配的小程序可以授权给此第三方平台，其他小程序扫码授权会直接提示此第三方平台待全网发布。在开发阶段最好不要全网发布，一旦全网发布再次修改平台的某些设置就需要微信审核，这会影响开发进度。

2. 授权事件接收URL设置，微信会每10分钟调一次这个url，我们可以在这个url代码中获取component_verify_ticket以供后续的业务逻辑使用，[参见我的另一篇博文](https://daijunooo.github.io/2018/08/26/openthird/)，值得一提的是这个业务代码中获取参数的方式需要使用输入流，见以下代码：

``` php
$params = file_get_contents('php://input');
```

3. 小程序服务器域名配置，这里要注意，不仅要把小程序的后台接口域名配进去，小程序中用的图片地址如果和接口地址不一致，那么图片的域名地址也要配进去并且要使用https的域名，小程序还有其他一些请求也都要配进去并且也都要是https域名。

4. 小程序业务域名配置，这个就是小程序的接口域名。


### 微信开发者工具使用的坑
1. 微信第三方小程序开发时，新建项目时填的appid必须是第三方平台里绑定的开发小程序的appid，用这个appid开发时才能正确上传代码到微信第三方小程序模板库。

2. ext.json 文件使用的一些坑，见以下代码：

``` php
"extEnable": true,
"extAppid": "wx775a25089efc6de3", //此处填的appid应该是授权给此第三方平台的小程序
"directCommit": false,
"ext": { //ext 所有信息一般都是和extAppid对应小程序的信息，所以这里面如果有appid一般会和extAppid相同
  "uid": "17165",
    "appid":"wx775a25089efc6de3"
  },
```
